accounts:
  file: example.gnucash
taxonomy:
  file: taxonomy/ct-dpl.yaml
  id: corptax
metadata:
  business:
    activities: Computer security consultancy and development services
    average-employees:
    - 2
    - 1
    company-formation:
      country: england-and-wales
      date: '2019-03-01'
      form: private-limited-company
    company-name: Example Biz Ltd.
    company-number: '12345678'
    entity-scheme: http://www.companieshouse.gov.uk/
    contact:
      address:
      - 123 Leadbarton Street
      - Dumpston Trading Estate
      country: UK
      county: Minchingshire
      email: corporate@example.org
      location: Threapminchington
      name: Corporate Enquiries
      phone:
        area: '7900'
        country: '+44'
        number: '0123456'
        type: landline
      postcode: QQ99 9ZZ
    directors:
    - A Bloggs
    - B Smith
    - C Jones
    industry-sector: m
    is-dormant: false
    sic-codes:
    - '62020'
    - '62021'
    vat-registration: GB012345678
    website:
      description: Corporate website
      url: https://example.org/corporate
  report:
    pretty-print: true
    accounting-standards: micro-entities
    accounts-status: audit-exempt-no-accountants-report
    accounts-type: abridged-accounts
    authorised-date: '2021-01-01'
    balance-sheet-date: '2020-12-31'
    currency: GBP
    date: '2021-01-01'
    fy1:
      name: FY1
      start: '2020-01-01'
      end: '2020-03-31'
    fy2:
      name: FY2
      start: '2020-04-01'
      end: '2020-12-31'
    periods:
    - name: '2020'
      start: '2020-01-01'
      end: '2020-12-31'
    signed-by: B Smith
    signing-officer: director2
    title: Unaudited Micro-Entity Accounts
  tax:
    utr: '8596148860'
    period:
      name: '2020'
      start: '2020-01-01'
      end: '2020-12-31'
computations:

- description: Turnover / revenue
  id: turnover
  kind: group
  inputs:
  - kind: round
    description: Income
    period: in-year
    input:
      kind: line
      description: Income from main trade
      period: in-year
      accounts:
      - Income
  period: in-year

- id: ct-annual-investment-allowance
  kind: round
  description: Annual investment allowance
  period: in-year
  segments:
    business-type: management-expenses
  input:
    kind: line
    period: in-year
    reverse-sign: true
    segments:
      business-type: management-expenses
    accounts:
    - Assets:Capital Equipment:Computer Equipment

- id: gross-profit
  kind: round
  description: Gross Profit
  period: in-year
  input:
    kind: sum
    description:
    period: in-year
    inputs:
    - turnover
- id: salaries
  kind: line
  description: Salaries
  period: in-year
  accounts:
  - Expenses:Emoluments:Employees
- id: pensions
  kind: line
  description: Pension contributions
  period: in-year
  accounts:
  - Expenses:Emoluments:Employer Pension Contribution
- id: bank-charges
  kind: line
  description: Bank charges
  period: in-year
  accounts:
  - Expenses:VAT Purchases:Bank Charges
- accounts:
  - Expenses:VAT Purchases:Office
  description: Office costs
  id: office
  kind: line
  period: in-year
- accounts:
  - Expenses:VAT Purchases:Software
  description: Software
  id: software-expenses
  kind: line
  period: in-year
- accounts:
  - Expenses:VAT Purchases:Sundries
  description: Sundries
  id: sundries
  kind: line
  period: in-year
- accounts:
  - Expenses:VAT Purchases:Travel/Accom
  description: Travel
  id: travel
  kind: line
  period: in-year
- id: ct-management-expenses
  kind: round
  description: Management Expenses
  period: in-year
  input:
    kind: line
    period: in-year
    accounts:
    - Expenses:Emoluments:Employees
    - Expenses:Emoluments:Employer Pension Contribution
    - Expenses:VAT Purchases:Accountant
    - Expenses:VAT Purchases:Bank Charges
    - Expenses:VAT Purchases:Office
    - Expenses:VAT Purchases:Software
    - Expenses:VAT Purchases:Subscriptions
    - Expenses:VAT Purchases:Sundries
    - Expenses:VAT Purchases:Telecoms
    - Expenses:VAT Purchases:Travel/Accom
    - Expenses:R&D Enhanced Expenditure
  segments:
    business-type: management-expenses

- id: ct-trading-profits
  kind: group
  description: Trading profits
  period: in-year
  segments:
    business-type: company
  inputs:
  - gross-profit
  - ct-annual-investment-allowance

- id: ct-net-chargeable-gains
  kind: sum
  description: Net chargeable gains
  inputs: []
  period: in-year
  segments:
    business-type: company

- id: ct-profits
  kind: group
  description: Profits chargeable to corporation tax
  period: in-year
  segments:
    business-type: company
  inputs:
  - ct-trading-profits
  - ct-management-expenses

- id: ct-profits-total-by-fy
  kind: group
  description: Profits, breakdown by FY
  period: in-year
  segments:
    business-type: company
  inputs:
   - ct-profits

- id: ct-profit-before-tax-fy1
  kind: round
  description: FY1
  period: in-year
  input:
    kind: apportion
    description: FY1
    period: in-year
    input: ct-profits
    whole-period: metadata.report.periods.0
    proportion-period: metadata.report.fy1
  segments:
    business-type: company

- id: ct-profit-before-tax-fy2
  kind: round
  description: FY2
  period: in-year
  input:
    kind: apportion
    description: FY2
    period: in-year
    input: ct-profits
    whole-period: metadata.report.periods.0
    proportion-period: metadata.report.fy2
  segments:
    business-type: company

- id: ct-profit-before-tax-total
  description: Profits, by financial year
  kind: group
  period: in-year
  inputs:
  - ct-profit-before-tax-fy1
  - ct-profit-before-tax-fy2
  segments:
    business-type: company

- id: ct-tax-fy1
  kind: factor
  description: FY1 (19%)
  factor: -0.19
  period: in-year
  input: ct-profit-before-tax-fy1
  reverse-sign: true
  segments:
    business-type: company
- id: ct-tax-fy2
  kind: factor
  description: FY2 (19%)
  factor: -0.19
  period: in-year
  input: ct-profit-before-tax-fy2
  reverse-sign: true
  segments:
    business-type: company
- id: ct-tax-total
  description: Corporation tax chargeable
  kind: group
  inputs:
  - ct-tax-fy1
  - ct-tax-fy2
  period: in-year
  segments:
    business-type: company
- id: ct-tax-owed
  kind: sum
  inputs: [ct-tax-total]
- id: accountancy
  accounts:
  - Expenses:VAT Purchases:Accountant
  description: Accountancy services
  kind: line
  period: in-year
- id: subscriptions-costs
  kind: line
  description: Subscriptions
  period: in-year
  accounts:
  - Expenses:VAT Purchases:Subscriptions
- id: telecoms
  kind: line
  description: Telecoms
  period: in-year
  accounts:
  - Expenses:VAT Purchases:Telecoms
- id: depreciation
  kind: line
  description: Depreciation
  period: in-year
  accounts:
  - Expenses:Depreciation
- id: rnd-enhanced-expenditure
  kind: line
  description: SME R&D enhanced expenditure
  period: in-year
  accounts:
  - Expenses:R&D Enhanced Expenditure
- id: rnd-enhanced-expenditure-rev
  kind: line
  description: SME R&D enhanced expenditure
  period: in-year
  reverse-sign: true
  accounts:
  - Expenses:R&D Enhanced Expenditure
- id: total-costs
  description: Total costs
  kind: group
  period: in-year
  inputs:
  - salaries
  - pensions
  - accountancy
  - bank-charges
  - office
  - software-expenses
  - subscriptions-costs
  - sundries
  - telecoms
  - travel
  - rnd-enhanced-expenditure
- id: profit-before-tax
  kind: group
  description: Profit before tax
  inputs:
  - gross-profit
  - total-costs
  - ct-annual-investment-allowance
  period: in-year
- id: corporation-tax
  kind: line
  description: Corporation Tax
  period: in-year
  accounts:
  - Equity:Corporation Tax
- id: tax-due
  description: Corporation tax
  kind: sum
  period: in-year
  inputs:
  - corporation-tax
- id: profit
  kind: sum
  description: Profit (Loss) after tax
  period: in-year
  inputs:
  - gross-profit
  - total-costs
  - ct-annual-investment-allowance
  - tax-due

worksheets:
- id: tax-calculation
  kind: multi-period
  description: Tax Calculation
  computations:
  - ct-trading-profits
  - ct-profits
  - ct-profit-before-tax-total
  - ct-tax-total
- id: detailed-profit-and-loss
  kind: multi-period
  description: Detailed Profit-and-Loss
  computations:
  - turnover
  - gross-profit
  - total-costs
  - profit-before-tax
  - tax-due
  - profit

elements:
- elements:
  - about
  - capital-allowances
  - profits
  - tax-chargeable
#  - rnd
  - rnd-creative-enhanced-expenditure
  - detailed-profit-and-loss
  - tax-calculation
  id: report
  kind: composite
- id: about
  kind: facttable
  title: Corporation Tax Return
  facts:
  - id: company-name
    kind: config
    description: Company name
    field: '1'
    context: report-date
    key: metadata.business.company-name
  - context: report-date
    description: Tax reference
    field: '3'
    id: tax-reference
    key: metadata.tax.utr
    kind: config
  - context: report-date
    description: Return period start
    field: '30'
    id: return-period-start
    key: metadata.tax.period.start
    kind: config-date
  - context: report-date
    description: Return period end
    field: '35'
    id: return-period-end
    key: metadata.tax.period.end
    kind: config-date
  - context: report-date
    description: Start of accounts period
    field: '-'
    id: account-period-start
    key: metadata.tax.period.start
    kind: config-date
  - context: report-date
    description: End of accounts period
    field: '-'
    id: account-period-end
    key: metadata.tax.period.end
    kind: config-date
  - context: report-period
    description: Company is a partner in a firm
    field: '-'
    id: partner-in-a-firm
    kind: bool
    value: false
- id: capital-allowances
  kind: facttable
  title: Capital allowances and balancing charges
  facts:
  - id: annual-investment-allowance
    context: report-period
    description: Annual investment allowance
    field: '690'
    computation: ct-annual-investment-allowance
    kind: computation
    period-config: metadata.tax.period
    context: management-expenses-period
- id: profits
  kind: facttable
  title: Profits and gains
  facts:
  - id: adjusted-trading-profit-of-this-period
    context: report-period
    description: Trading profits
    field: '155'
    computation: ct-trading-profits
    kind: computation
    period-config: metadata.tax.period
  - id: trading-losses-brought-forward
    description: Trading losses brough forward
    field: 160, 285
    context: report-period
    kind: money
    value: 0
  - id: net-trading-profits
    computation: ct-trading-profits
    context: report-period
    description: Net trading profits
    field: '165'
    kind: computation
    period-config: metadata.tax.period
  - context: report-period
    description: Net chargeable gains
    field: '220'
    id: net-chargeable-gains
    kind: computation
    computation: ct-net-chargeable-gains
    period-config: metadata.tax.period
  - id: profits-before-other-deductions-and-reliefs
    computation: ct-trading-profits
    context: report-period
    description: Profits before other deductions and reliefs
    field: '235'
    kind: computation
    period-config: metadata.tax.period
  - computation: ct-management-expenses
    context: management-expenses-period
    description: Management expenses
    field: '245'
    id: management-expenses
    kind: computation
    period-config: metadata.tax.period
  - computation: ct-management-expenses
    context: report-period
    description: Total deductions and reliefs
    field: '295'
    id: total-deductions-and-reliefs
    kind: computation
    period-config: metadata.tax.period
  - id: profits-before-charges-and-group-relief
    kind: computation
    computation: ct-profits
    context: report-period
    description: Profits before donations and group relief
    field: '300'
    period-config: metadata.tax.period
  - id: qualifying-donations
    context: report-period
    description: Qualifying donations
    field: '305'
    kind: money
    value: 0
  - context: report-period
    description: Group relief
    field: '310'
    id: group-relief-claimed
    kind: money
    value: 0
  - context: report-period
    description: Group relief for carried forward losses
    field: '312'
    id: group-relief-claimed-for-carried-forward-losses
    kind: money
    value: 0
  - computation: ct-profits
    context: report-period
    description: Profits chargeable to Corporation Tax
    field: '315'
    id: total-profits-chargeable-to-corporation-tax
    kind: computation
    period-config: metadata.tax.period
- id: tax-chargeable
  kind: facttable
  title: Tax chargeable
  facts:
  - id: financial-year1-covered-by-the-return
    context: report-period
    description: Financial year 1 covered by the return
    field: '330'
    kind: string
    value: '2019'
  - id: financial-year2-covered-by-the-return
    context: report-period
    description: Financial year 2 covered by the return
    field: '380'
    kind: string
    value: '2020'
  - id: fy1-amount-of-profit-chargeable-at-first-rate
    context: report-period
    description: FY1 profit chargeable at first rate
    field: '335'
    computation: ct-profit-before-tax-fy1
    kind: computation
    period-config: metadata.tax.period
  - id: fy2-amount-of-profit-chargeable-at-first-rate
    context: report-period
    description: FY2 profit chargeable at first rate
    field: '385'
    computation: ct-profit-before-tax-fy2
    kind: computation
    period-config: metadata.tax.period
  - id: fy1-first-rate-of-tax
    context: report-period
    description: FY1 first rate of tax (%)
    field: '340'
    kind: number
    value: 19
  - id: fy2-first-rate-of-tax
    context: report-period
    description: FY2 first rate of tax (%)
    field: '390'
    kind: number
    value: 19
  - id: fy1-tax-at-first-rate
    computation: ct-tax-fy1
    context: report-period
    description: FY1 tax at first rate
    field: '345'
    kind: computation
    period-config: metadata.tax.period
  - id: fy2-tax-at-first-rate
    computation: ct-tax-fy2
    context: report-period
    description: FY2 tax at first rate
    field: '395'
    kind: computation
    period-config: metadata.tax.period
  - id: corporation-tax-chargeable
    computation: ct-tax-total
    context: report-period
    description: Corporation tax
    field: '430'
    kind: computation
    period-config: metadata.tax.period
  - context: report-period
    description: Marginal relief for ring fence trades
    field: '435'
    id: marginal-rate-relief-for-ring-fence-trades-payable
    kind: money
    value: 0
  - computation: ct-tax-owed
    context: report-period
    description: Corporation tax chargeable
    field: '440'
    id: corporation-tax-chargeable-payable
    kind: computation
    period-config: metadata.tax.period
  - id: total-reliefs-and-deductions-in-terms-of-tax-payable
    context: report-period
    description: Total reliefs and deduction in terms of tax
    field: '470'
    kind: money
    value: 0
    period-config: metadata.tax.period
  - id: net-corporation-tax-payable
    kind: computation
    context: report-period
    computation: ct-tax-owed
    description: Net Corporation Tax liability
    field: '475'
    period-config: metadata.tax.period
  - id: tax-chargeable
    kind: computation
    context: report-period
    computation: ct-tax-owed
    description: Tax chargeable
    field: '510'
    period-config: metadata.tax.period
  - id: tax-payable
    kind: computation
    context: report-period
    computation: ct-tax-owed
    description: Tax payable
    field: '525'
    period-config: metadata.tax.period

# - id: rnd
#   kind: facttable
#   title: SME R&D
#   facts:
#   - id: company-name
#     kind: config
#     description: Company name
#     field: 'L1'
#     context: report-date
#     key: metadata.business.company-name

#   - id: tax-reference
#     kind: config
#     context: report-date
#     description: Tax reference
#     field: 'L2'
#     key: metadata.tax.utr

#   - context: report-date
#     description: Return period start
#     field: 'L3'
#     id: return-period-start
#     key: metadata.tax.period.start
#     kind: config-date
#   - context: report-date
#     description: Return period end
#     field: 'L4'
#     id: return-period-end
#     key: metadata.tax.period.end
#     kind: config-date

#   - id: rnd-tax-credit-claim
#     kind: money
#     description: Payable tax credit claim
#     field: L170
#     context: report-period
#     value: 0
#     period-config: metadata.tax.period

#   - id: rnd-tax-credit-offset
#     kind: money
#     description: Payable tax credit against other liabilities
#     field: L175
#     value: 0
#     context: report-period
#     period-config: metadata.tax.period

#   - id: rnd-tax-credit-payable
#     kind: money
#     description: Tax credit balance payable
#     field: L180
#     context: report-period
#     value: 0
#     period-config: metadata.tax.period

#   - id: rnd-tax-credit-discharged
#     kind: money
#     description: Credit discharging other liabilities
#     field: L205
#     context: report-period
#     value: 0
#     period-config: metadata.tax.period

#   - id: rnd-tax-credit-offset
#     kind: money
#     description: Total R&D credit set off against liabilities
#     field: L210
#     context: report-period
#     value: 0
#     period-config: metadata.tax.period

- id: rnd-creative-enhanced-expenditure
  kind: facttable
  title: R&D / Creative enhanced expenditure
  facts:

  - id: rnd-enhanced-sme
    description: Small or medium-sized enterprise
    field: '650'
    context: report-period
    kind: bool
    value: true

  - id: rnd-enhanced-large
    description: Large company
    field: '655'
    context: report-period
    kind: bool
    value: false

  - id: rnd-enhanced-expenditure
    kind: computation
    description: R&D enhanced expenditure
    field: '660'
    context: report-period
    computation: rnd-enhanced-expenditure-rev
    period-config: metadata.tax.period

  - id: creative-enhanced-expenditure
    kind: money
    description: Creative enhanced expenditure
    field: '665'
    context: report-period
    value: 0
    period-config: metadata.tax.period

  - id: rnd-creative-enhanced-expenditure
    kind: computation
    description: R&D / Creative enhanced expenditure
    field: '670'
    context: report-period
    computation: rnd-enhanced-expenditure-rev
    period-config: metadata.tax.period

  - id: rnd-enhanced-expenditure-subcontracted
    kind: money
    description: R&D subcontracted by a large company
    field: '675'
    context: report-period
    value: 0
    period-config: metadata.tax.period

- id: tax-calculation
  kind: worksheet
  title: Tax calculation
  worksheet: tax-calculation

- id: detailed-profit-and-loss
  kind: worksheet
  title: Detailed Profit-and-Loss
  worksheet: detailed-profit-and-loss
